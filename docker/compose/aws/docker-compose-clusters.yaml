####################################################################################################################################################################################
#
# Note: This file is generated by the script: generate-cluster-setup.py
#
####################################################################################################################################################################################

version: '3'

####################################################################################################################################################################################

networks:
  imaginationsupport:

####################################################################################################################################################################################

services:

####################################################################################################################################################################################
# demo cluster
####################################################################################################################################################################################

  ldap-demo:
    image: 660195182610.dkr.ecr.us-east-1.amazonaws.com/ldap:prod
    container_name: ldap-demo
    restart: always
    ports:
      - "3891:389"
    volumes:
      - ldap-demo-config:/etc/openldap-dist
      - ldap-demo-data:/var/lib/openldap
    env_file:
      - env/aws-demo.env
#    environment:
#      - USE_LDAP_LOGGING=true
    networks:
      - imaginationsupport

##########################################################################################

  web-ui-demo:
    image: 660195182610.dkr.ecr.us-east-1.amazonaws.com/web-ui-ara:prod
    container_name: web-ui-demo
    restart: always
    depends_on:
      - ldap-demo
      - mongo-db-demo
    env_file:
      - env/aws-demo.env
    deploy:
      resources:
        limits:
          memory: 4g
    volumes:
      - /docker-data/volumes/demo-web-ui:/usr/local/tomcat/logs
    networks:
      - imaginationsupport

##########################################################################################

  mongo-db-demo:
    image: 660195182610.dkr.ecr.us-east-1.amazonaws.com/mongo-db:prod
    container_name: mongo-db-demo
    restart: always
    ports:
      - "27022:27017"
    volumes:
      - mongo-db-demo-data:/data/db
    env_file:
      - env/aws-demo.env
    deploy:
      resources:
        limits:
          memory: 4g
    networks:
      - imaginationsupport

##########################################################################################

  swagger-ui-demo:
    image: 660195182610.dkr.ecr.us-east-1.amazonaws.com/swagger-ui:prod
    container_name: swagger-ui-demo
    restart: always
    environment:
      - API_URL=/scenarioexplorer/swagger-v2.yaml
    depends_on:
      - web-ui-demo
    networks:
      - imaginationsupport

####################################################################################################################################################################################
# ncsu cluster
####################################################################################################################################################################################

  ldap-ncsu:
    image: 660195182610.dkr.ecr.us-east-1.amazonaws.com/ldap:prod
    container_name: ldap-ncsu
    restart: always
    ports:
      - "3892:389"
    volumes:
      - ldap-ncsu-config:/etc/openldap-dist
      - ldap-ncsu-data:/var/lib/openldap
    env_file:
      - env/aws-ncsu.env
#    environment:
#      - USE_LDAP_LOGGING=true
    networks:
      - imaginationsupport

##########################################################################################

  web-ui-ncsu:
    image: 660195182610.dkr.ecr.us-east-1.amazonaws.com/web-ui-ncsu:prod
    container_name: web-ui-ncsu
    restart: always
    depends_on:
      - ldap-ncsu
      - mongo-db-ncsu
    env_file:
      - env/aws-ncsu.env
    deploy:
      resources:
        limits:
          memory: 4g
    volumes:
      - /docker-data/volumes/ncsu-web-ui:/usr/local/tomcat/logs
    networks:
      - imaginationsupport

##########################################################################################

  mongo-db-ncsu:
    image: 660195182610.dkr.ecr.us-east-1.amazonaws.com/mongo-db:prod
    container_name: mongo-db-ncsu
    restart: always
    ports:
      - "27023:27017"
    volumes:
      - mongo-db-ncsu-data:/data/db
    env_file:
      - env/aws-ncsu.env
    deploy:
      resources:
        limits:
          memory: 4g
    networks:
      - imaginationsupport

##########################################################################################

  swagger-ui-ncsu:
    image: 660195182610.dkr.ecr.us-east-1.amazonaws.com/swagger-ui:prod
    container_name: swagger-ui-ncsu
    restart: always
    environment:
      - API_URL=/scenarioexplorer/swagger-v2.yaml
    depends_on:
      - web-ui-ncsu
    networks:
      - imaginationsupport

####################################################################################################################################################################################
# ara-dev cluster
####################################################################################################################################################################################

  ldap-ara-dev:
    image: 660195182610.dkr.ecr.us-east-1.amazonaws.com/ldap:dev
    container_name: ldap-ara-dev
    restart: always
    ports:
      - "3901:389"
    volumes:
      - ldap-ara-dev-config:/etc/openldap-dist
      - ldap-ara-dev-data:/var/lib/openldap
    env_file:
      - env/aws-ara-dev.env
#    environment:
#      - USE_LDAP_LOGGING=true
    networks:
      - imaginationsupport

##########################################################################################

  web-ui-ara-dev:
    image: 660195182610.dkr.ecr.us-east-1.amazonaws.com/web-ui-ara:dev
    container_name: web-ui-ara-dev
    restart: always
    depends_on:
      - ldap-ara-dev
      - mongo-db-ara-dev
    env_file:
      - env/aws-ara-dev.env
    deploy:
      resources:
        limits:
          memory: 2g
    volumes:
      - /docker-data/volumes/ara-dev-web-ui:/usr/local/tomcat/logs
    networks:
      - imaginationsupport

##########################################################################################

  mongo-db-ara-dev:
    image: 660195182610.dkr.ecr.us-east-1.amazonaws.com/mongo-db:dev
    container_name: mongo-db-ara-dev
    restart: always
    ports:
      - "27017:27017"
    volumes:
      - mongo-db-ara-dev-data:/data/db
    env_file:
      - env/aws-ara-dev.env
    deploy:
      resources:
        limits:
          memory: 2g
    networks:
      - imaginationsupport

##########################################################################################

  swagger-ui-ara-dev:
    image: 660195182610.dkr.ecr.us-east-1.amazonaws.com/swagger-ui:dev
    container_name: swagger-ui-ara-dev
    restart: always
    environment:
      - API_URL=/scenarioexplorer/swagger-v2.yaml
    depends_on:
      - web-ui-ara-dev
    networks:
      - imaginationsupport

####################################################################################################################################################################################
# ncsu-dev cluster
####################################################################################################################################################################################

  ldap-ncsu-dev:
    image: 660195182610.dkr.ecr.us-east-1.amazonaws.com/ldap:dev
    container_name: ldap-ncsu-dev
    restart: always
    ports:
      - "3902:389"
    volumes:
      - ldap-ncsu-dev-config:/etc/openldap-dist
      - ldap-ncsu-dev-data:/var/lib/openldap
    env_file:
      - env/aws-ncsu-dev.env
#    environment:
#      - USE_LDAP_LOGGING=true
    networks:
      - imaginationsupport

##########################################################################################

  web-ui-ncsu-dev:
    image: 660195182610.dkr.ecr.us-east-1.amazonaws.com/web-ui-ncsu:dev
    container_name: web-ui-ncsu-dev
    restart: always
    depends_on:
      - ldap-ncsu-dev
      - mongo-db-ncsu-dev
    env_file:
      - env/aws-ncsu-dev.env
    deploy:
      resources:
        limits:
          memory: 2g
    volumes:
      - /docker-data/volumes/ncsu-dev-web-ui:/usr/local/tomcat/logs
    networks:
      - imaginationsupport

##########################################################################################

  mongo-db-ncsu-dev:
    image: 660195182610.dkr.ecr.us-east-1.amazonaws.com/mongo-db:dev
    container_name: mongo-db-ncsu-dev
    restart: always
    ports:
      - "27018:27017"
    volumes:
      - mongo-db-ncsu-dev-data:/data/db
    env_file:
      - env/aws-ncsu-dev.env
    deploy:
      resources:
        limits:
          memory: 2g
    networks:
      - imaginationsupport

####################################################################################################################################################################################

volumes:
  mongo-db-demo-data:
  ldap-demo-config:
  ldap-demo-data:
  mongo-db-ncsu-data:
  ldap-ncsu-config:
  ldap-ncsu-data:
  mongo-db-ara-dev-data:
  ldap-ara-dev-config:
  ldap-ara-dev-data:
  mongo-db-ncsu-dev-data:
  ldap-ncsu-dev-config:
  ldap-ncsu-dev-data:

####################################################################################################################################################################################
